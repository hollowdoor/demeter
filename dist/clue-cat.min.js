!function(t){"use strict";function e(t,e,r){return void 0===r&&(void 0===e?(r=t,e={},t=""):r=e),[t,e,r]}function r(t,e,r){void 0===e&&(e={}),void 0===r&&(r=!0),t=t?"\n"+t:"",t+="\n  ---\n"+Object.keys(e).reduce(function(t,r){return t+"  "+r+": "+e[r]+"\n"},"")+"  ...\n";var n=new Error(t);return n.passed=!!r,n.failed=!r,n}function n(t){return v(t)}var o=function(){};o.prototype.assert=function(t,e,n){if(void 0===n&&(n={}),!t)throw r(e,{operator:"assert",expected:!0,actual:t},!1)},o.prototype.fail=function(t){throw r(t,{operator:"fail"},!1)},o.prototype.equal=function(t,e,n){if(void 0===n&&(n=""),t!==e)throw r(n,{operator:"equal",expected:t,actual:e},!1)},o.prototype.reject=function(t){void 0===t&&(t="");var e=r(t,{operator:"reject"},!1);return Promise.reject(e)};var i=function(t){void 0===t&&(t={});var e=t.description;void 0===e&&(e="");var r=t.count;void 0===r&&(r=0);var n=t.read;void 0===n&&(n=null);var o=t.rethrow;void 0===o&&(o=!1);var i=Promise.resolve(),u=!1;Object.defineProperties(this,{rethrow:{value:o}}),this.getResult=function(t,r){return{description:e,passed:!!r,failed:!r,value:t}},this.write=function(t){return u?this:o?(u=!0,i=i.then(function(e){return t}).then(function(t){return t.value&&t.value instanceof Error?Promise.reject(new Error("# rethrow test \n"+t.value.message.split("\n").join("\n  ")+"\n")):t}),this):(i=i.then(function(e){return t}).then(function(t){return n(t)}),this)},this.end=function(){return i}};i.prototype.pass=function(t){return this.getResult(t,!0)},i.prototype.fail=function(t){return this.getResult(t,!1)},i.prototype.asserts=function(){return new o},i.prototype.toPromise=function(t){try{return t}catch(t){return Promise.reject(t)}},i.prototype.resolve=function(t,e){var r=this;void 0===e&&(e=!1);try{var n=t(this.asserts());return"object"==typeof n&&"function"==typeof n.run&&(n=n.run(null,{rethrow:!0})),e?Promise.resolve(n).then(function(t){return r.fail(t)}).catch(function(t){return r.pass(t)}):Promise.resolve(n).then(function(t){return r.pass(t)}).catch(function(t){return r.fail(t)})}catch(t){return e?this.pass(t):this.fail(t)}},i.prototype.reverse=function(t){return this.resolve(t,!0)};!function(){var t,e=!1;void 0===(t="undefined"==typeof global?window:global).TAP_VERSION_WRITTEN&&Object.defineProperty(t,"TAP_VERSION_WRITTEN",{get:function(){return e}})}();var u=function(t,e,r){var n="object"==typeof r?Object.assign({indent:" "},r):{indent:r||" "};if(e=void 0===e?1:e,"string"!=typeof t)throw new TypeError("Expected `input` to be a `string`, got `"+typeof t+"`");if("number"!=typeof e)throw new TypeError("Expected `count` to be a `number`, got `"+typeof e+"`");if("string"!=typeof n.indent)throw new TypeError("Expected `options.indent` to be a `string`, got `"+typeof n.indent+"`");if(0===e)return t;var o=n.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return t.replace(o,n.indent.repeat(e))},c=function(t){void 0===t&&(t={});t.description;var e=t.result;void 0===e&&(e={});var r=t.count;void 0===r&&(r=0);t.rethrow;Object.defineProperty(this,"_result",{value:e}),Object.defineProperty(this,"count",{value:r,enumerable:!0}),this.tap=function(){var t=this.result();if(/^#/.test(t.description)){var e=function(t,e){return e.failed=t,e.passed=!t,e.value=new Error(""),e};/^#[ ]TODO/.test(t.description)?t=e(!0,t):/^#[ ]PASS/.test(t.description)&&(t=e(!1,t))}var n=t.description.length?t.description:"",o="";if(t.passed)o="ok "+r+" - "+n,t.value&&t.value.message&&/#[ ]rethrow[ ]test/.test(t.value.message)&&(o+=u(t.value.message,2));else if(t.failed){var i=t.value?t.value.message:"";o="not ok "+r+" - "+n+" "+i}return o}};c.prototype.result=function(){return this._result};var s=function(){var t={};return t.promise=new Promise(function(e,r){t.resolve=e,t.reject=r}),t},a=function(t){function e(e){t.call(this,e),this.name="CancelError"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),p=function(t){return function(e,r){e=e||0;var n=arguments.length>1,o=r,i=s(),u=i.promise,c=setTimeout(function(){(t?i.resolve:i.reject)(o)},e),p=function(t){return n||(o=t),u};return p.then=u.then.bind(u),p.catch=u.catch.bind(u),p._actualPromise=u,p.cancel=function(){c&&(clearTimeout(c),c=null,i.reject(new a("Delay canceled")))},p}},v=p(!0),l=p(!1),f=a;v.reject=l,v.CancelError=f;var d=function(t){function r(e){void 0===e&&(e={});var r=e.description;void 0===r&&(r="");var n=e.run;void 0===n&&(n=null);var o=e.print;void 0===o&&(o=null);var i=e.time;void 0===i&&(i=null);var u=e.count;void 0===u&&(u=0);var c=e.rethrow;void 0===c&&(c=!1),t.call(this,{description:r,run:n,print:o,time:i,count:u,rethrow:c})}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.test=function(t,r,n){var o,i=this;return o=e(t,r,n),t=o[0],r=o[1],n=o[2],new this.constructor({description:t,time:this.startTime,count:this.count+1,rethrow:r.rethrow,print:function(t){var e=t.tap();console.log(e)},run:function(t){return i.run(function(){var e=t.resolve(n);return t.write(e).end()},!0)}})},r.prototype.reverse=function(t,r,n){var o,i=this;return o=e(t,r,n),t=o[0],r=o[1],n=o[2],new this.constructor({description:t,time:this.startTime,count:this.count+1,rethrow:r.rethrow,print:function(t){var e=t.tap();console.log(e)},run:function(t){return i.run(function(){var e=t.reverse(n);return t.write(e).end()},!0)}})},r}(function(t){void 0===t&&(t={});var e=t.description;void 0===e&&(e="");var r=t.run;void 0===r&&(r=null);var o=t.print;void 0===o&&(o=null);var u=t.time;void 0===u&&(u=null);var s=t.count;void 0===s&&(s=0);var a=t.rethrow;void 0===a&&(a=!1);var p=n(1),v=[];this["@@testinstance"]=!0,u=u||Date.now(),Object.defineProperties(this,{count:{get:function(){return s}},startTime:{value:u},rethrow:{value:a}}),Object.defineProperty(this,"include",{value:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];v=v.concat(t)}}),Object.defineProperty(this,"run",{value:function(t,n){if(void 0===n)(n={}).keepTesting=!0,n.rethrow=!1;else if("boolean"==typeof n){var a=n;(n={}).keepTesting=a,n.rethrow=!1}else"object"==typeof n&&(void 0===n.keepTesting?n.keepTesting=!0:n.keepTesting=!!n.keepTesting,n.rethrow=!!n.rethrow);var l,f=n.keepTesting,d=n.rethrow;return r&&(l=new i({description:e,rethrow:d,read:function(t){return o(new c({result:t,count:s}))}})),v.length&&(p=v.reduce(function(t,e){return t.then(function(t){return e.run()})},Promise.resolve())),r?(p=p.then(function(t){return r(l)})).then(function(e){try{return t?t(e):value}catch(t){return Promise.reject(t)}}).then(function(t){return f||d||(console.log("1.."+s),console.log("# duration "+(Date.now()-u)+"ms")),t}):t?Promise.resolve().then(t):Promise.resolve()}})});t.ClueCatTest=d,t.test=function(t){return void 0===t&&(t={}),new d(t)}}(this.clueCat=this.clueCat||{});
//# sourceMappingURL=clue-cat.min.js.map
