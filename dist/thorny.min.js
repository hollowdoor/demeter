!function(t){"use strict";function e(t,e,r){void 0===e&&(e={}),void 0===r&&(r=!0),t=t?"\n"+t:"",t+="\n  ---\n"+Object.keys(e).reduce(function(t,r){return t+"  "+r+": "+e[r]+"\n"},"")+"  ...\n";var n=new Error(t);return n.passed=!!r,n.failed=!r,n}function r(t,e,r){return void 0===r&&(void 0===e?(r=t,e={},t=""):r=e),[t,e,r]}function n(t){return l(t)}function o(t,e){void 0===t&&(t=[]),void 0===e&&(e={});try{var r=require("tap-merge"),n=(require("multistream"),require("child_process").spawn),o=r();return e.stdio=[null,"pipe",null],new Promise(function(r,i){var u=n("node",t,e);u.on("exit",r),u.on("error",i),u.stdout.pipe(o).pipe(process.stdout)})}catch(t){return Promise.reject(t)}}var i=function(){};i.prototype.assert=function(t,r,n){if(void 0===n&&(n={}),!t)throw e(r,{operator:"assert",expected:!0,actual:t},!1)},i.prototype.fail=function(t){throw e(t,{operator:"fail"},!1)},i.prototype.equal=function(t,r,n){if(void 0===n&&(n=""),t!==r)throw e(n,{operator:"equal",expected:t,actual:r},!1)},i.prototype.reject=function(t){void 0===t&&(t="");var r=e(t,{operator:"reject"},!1);return Promise.reject(r)};var u=function(t){void 0===t&&(t={});var e=t.description;void 0===e&&(e="");var r=t.count;void 0===r&&(r=0);var n=t.read;void 0===n&&(n=null);var o=t.rethrow;void 0===o&&(o=!1);var i=Promise.resolve(),u=!1;Object.defineProperties(this,{rethrow:{value:o}}),this.getResult=function(t,r){return{description:e,passed:!!r,failed:!r,value:t}},this.write=function(t){return u?this:o?(u=!0,i=i.then(function(e){return t}).then(function(t){return t.value&&t.value instanceof Error?Promise.reject(new Error("\n\n  # rethrown test \n"+t.value.message.split("\n").join("\n  ")+"\n")):t}),this):(i=i.then(function(e){return t}).then(function(t){return n(t)}),this)},this.end=function(){return i}};u.prototype.pass=function(t){return this.getResult(t,!0)},u.prototype.fail=function(t){return this.getResult(t,!1)},u.prototype.asserts=function(){return new i},u.prototype.resolve=function(t){var e=this;try{return Promise.resolve(t(this.asserts())).then(function(t){return e.pass(t)}).catch(function(t){return e.fail(t)})}catch(t){return this.fail(t)}},u.prototype.reverse=function(t){var e=this;try{return Promise.resolve(t(this.asserts())).then(function(t){return e.fail(t)}).catch(function(t){return e.pass(t)})}catch(t){return this.pass(t)}};var c=function(t){void 0===t&&(t={});t.description;var e=t.result;void 0===e&&(e={});var r=t.count;void 0===r&&(r=0),Object.defineProperty(this,"_result",{value:e}),Object.defineProperty(this,"count",{value:r,enumerable:!0}),this.tap=function(){var t=this.result();if(/^#/.test(t.description)){var e=function(t,e){return e.failed=t,e.passed=!t,e.value=new Error(""),e};/^#[ ]TODO/.test(t.description)?t=e(!0,t):/^#[ ]PASS/.test(t.description)&&(t=e(!1,t))}var n=t.description.length?t.description:"",o="";if(t.passed)o="ok "+r+" - "+n;else if(t.failed){var i=t.value?t.value.message:"";o="not ok "+r+" - "+n+" "+i}return o}};c.prototype.result=function(){return this._result};var s=function(){var t={};return t.promise=new Promise(function(e,r){t.resolve=e,t.reject=r}),t},a=function(t){function e(e){t.call(this,e),this.name="CancelError"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),v=function(t){return function(e,r){e=e||0;var n=arguments.length>1,o=r,i=s(),u=i.promise,c=setTimeout(function(){(t?i.resolve:i.reject)(o)},e),v=function(t){return n||(o=t),u};return v.then=u.then.bind(u),v.catch=u.catch.bind(u),v._actualPromise=u,v.cancel=function(){c&&(clearTimeout(c),c=null,i.reject(new a("Delay canceled")))},v}},l=v(!0),f=v(!1),p=a;l.reject=f,l.CancelError=p;var d=function(){var t,e=!1;return void 0===(t="undefined"==typeof global?window:global).TAP_VERSION_WRITTEN&&Object.defineProperty(t,"TAP_VERSION_WRITTEN",{get:function(){return e}}),function(){t.TAP_VERSION_WRITTEN||(console.log("TAP version 13"),e=!0)}}(),h=function(t){void 0===t&&(t={});var e=t.description;void 0===e&&(e="");var r=t.run;void 0===r&&(r=null);var o=t.print;void 0===o&&(o=null);var i=t.time;void 0===i&&(i=null);var s=t.count;void 0===s&&(s=0);var a=t.rethrow;void 0===a&&(a=!1),d();var v=n(1);this["@@testinstance"]=!0,i=i||Date.now(),Object.defineProperties(this,{count:{get:function(){return s}},startTime:{value:i},rethrow:{value:a}});var l;r&&(l=new u({description:e,rethrow:a,read:function(t){return o(new c({result:t,count:s}))}}));var f=[];Object.defineProperty(this,"include",{value:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];f=f.concat(t)}}),Object.defineProperty(this,"done",{value:function(t,e){return f.length&&(v=f.reduce(function(t,e){return t.then(function(t){return e.done()})},Promise.resolve())),r?(v=v.then(function(t){return r(l)})).then(function(r){e||a||(console.log("1.."+s),console.log("# duration "+(Date.now()-i)+"ms"));try{return t?t(r):v.then(function(t){return r})}catch(t){return Promise.reject(t)}}):t?Promise.resolve().then(t):Promise.resolve()}})};h.prototype.test=function(t,e,n){var o,i=this;return o=r(t,e,n),t=o[0],e=o[1],n=o[2],new this.constructor({description:t,time:this.startTime,count:this.count+1,rethrow:e.rethrow,print:function(t){var e=t.tap();console.log(e)},run:function(t){return i.done(function(){var e=t.resolve(n);return t.write(e).end()},!0)}})},h.prototype.reverse=function(t,e,n){var o,i=this;return o=r(t,e,n),t=o[0],e=o[1],n=o[2],new this.constructor({description:t,time:this.startTime,count:this.count+1,rethrow:e.rethrow,print:function(t){var e=t.tap();console.log(e)},run:function(t){return i.done(function(){var e=t.reverse(n);return t.write(e).end()},!0)}})},t.ThornyTest=h,t.thorny=function(t){return void 0===t&&(t={}),new h(t)},t.run=function(t,e,r){void 0===e?(e={},r=[]):void 0===r&&("[object Array]"===Object.prototype.toString.call(e)?(r=e,e={}):r=[]),e.env=Object.assign(e.env||{},{TEST_ENVIRONMENT:!0});try{var n=require("glob-promise");return require("path"),process.cwd(),n(t,e).then(function(t){return Promise.all(t.map(function(t){return o([t].concat(r),e)}))})}catch(t){return Promise.reject(t)}}}(this.thorny=this.thorny||{});
//# sourceMappingURL=thorny.min.js.map
